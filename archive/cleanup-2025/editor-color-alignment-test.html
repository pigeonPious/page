<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editor Color Alignment Test</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      margin: 20px;
      line-height: 1.6;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .test-button {
      margin: 5px;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      background: #007acc;
      color: white;
      cursor: pointer;
    }
    .test-button:hover {
      background: #005a9e;
    }
    .iframe-container {
      margin: 10px 0;
      border: 1px solid #ddd;
      display: flex;
      gap: 10px;
    }
    iframe {
      width: 48%;
      height: 400px;
      border: none;
    }
    .test-log {
      background: #f5f5f5;
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
    }
    .color-sample {
      display: inline-block;
      width: 20px;
      height: 20px;
      margin: 0 5px;
      border: 1px solid #ccc;
      vertical-align: middle;
    }
  </style>
</head>
<body>

<h1>Editor Color Alignment Test</h1>
<p>This test verifies that text colors in the editor properly align with the main page theme across all view modes.</p>

<div class="test-section">
  <h2>Test Controls</h2>
  <button class="test-button" onclick="setThemeAndTest('light')">Test Light Theme</button>
  <button class="test-button" onclick="setThemeAndTest('dark')">Test Dark Theme</button>
  <button class="test-button" onclick="setThemeAndTest('custom', 'hsl(240, 100%, 20%)')">Test Custom Blue</button>
  <button class="test-button" onclick="setThemeAndTest('custom', 'hsl(120, 50%, 30%)')">Test Custom Green</button>
  <button class="test-button" onclick="setThemeAndTest('custom', 'hsl(0, 70%, 25%)')">Test Custom Red</button>
  <button class="test-button" onclick="checkColorVariables()">Check Color Variables</button>
</div>

<div class="test-section">
  <h2>Side-by-Side Comparison</h2>
  <p>Main Site (left) vs Editor (right) - Colors should match perfectly</p>
  <div class="iframe-container">
    <iframe id="mainSite" src="index.html" title="Main Site"></iframe>
    <iframe id="editor" src="editor.html" title="Editor"></iframe>
  </div>
</div>

<div class="test-section">
  <h2>Color Analysis</h2>
  <div id="colorAnalysis">
    <p>Theme analysis will appear here when you run tests...</p>
  </div>
</div>

<div class="test-section">
  <h2>Test Log</h2>
  <div id="testLog" class="test-log"></div>
</div>

<script>
function log(message) {
  const testLog = document.getElementById('testLog');
  const timestamp = new Date().toLocaleTimeString();
  testLog.textContent += `[${timestamp}] ${message}\n`;
  testLog.scrollTop = testLog.scrollHeight;
}

function setThemeAndTest(theme, customBg = null) {
  localStorage.setItem('theme', theme);
  if (theme === 'custom' && customBg) {
    localStorage.setItem('customBg', customBg);
    log(`Testing ${theme} theme with background: ${customBg}`);
  } else {
    localStorage.removeItem('customBg');
    log(`Testing ${theme} theme`);
  }
  
  // Reload both iframes
  setTimeout(() => {
    document.getElementById('mainSite').src = document.getElementById('mainSite').src;
    document.getElementById('editor').src = document.getElementById('editor').src;
    log('Reloaded both pages to apply theme');
    
    // Analyze colors after reload
    setTimeout(() => {
      analyzeColors(theme, customBg);
    }, 1000);
  }, 100);
}

function analyzeColors(theme, customBg = null) {
  const analysis = document.getElementById('colorAnalysis');
  
  // Expected color values based on theme
  const expectedColors = {
    light: {
      bg: '#f7f7f7',
      fg: '#232323',
      accent: '#3a7bd5',
      border: '#cccccc',
      muted: '#666666'
    },
    dark: {
      bg: '#272727',
      fg: '#acada8',
      accent: '#c7c9c3',
      border: '#343235',
      muted: '#6a696c'
    },
    custom: {
      bg: customBg || 'custom',
      fg: 'calculated based on lightness',
      accent: 'inherited or calculated',
      border: 'inherited',
      muted: 'inherited'
    }
  };
  
  const colors = expectedColors[theme] || expectedColors.light;
  
  analysis.innerHTML = `
    <h3>Expected Colors for ${theme.toUpperCase()} Theme:</h3>
    <p><span class="color-sample" style="background: ${colors.bg}"></span> Background: ${colors.bg}</p>
    <p><span class="color-sample" style="background: ${colors.fg}"></span> Text: ${colors.fg}</p>
    <p><span class="color-sample" style="background: ${colors.accent}"></span> Accent: ${colors.accent}</p>
    <p><span class="color-sample" style="background: ${colors.border}"></span> Border: ${colors.border}</p>
    <p><span class="color-sample" style="background: ${colors.muted}"></span> Muted: ${colors.muted}</p>
    
    <h4>Color Alignment Checklist:</h4>
    <ul>
      <li>✅ Text in editor title input should match main site text color</li>
      <li>✅ Editor background should match main site background</li>
      <li>✅ Placeholder text should use consistent muted color</li>
      <li>✅ Note highlights should use theme-appropriate accent colors</li>
      <li>✅ Menu hover states should match across both pages</li>
      <li>✅ Modal overlays should be appropriate for theme brightness</li>
    </ul>
    
    <p><strong>Visual Test:</strong> Check that text readability and contrast are consistent between main site and editor.</p>
  `;
  
  log(`Color analysis complete for ${theme} theme`);
}

function checkColorVariables() {
  const theme = localStorage.getItem('theme') || 'light';
  const customBg = localStorage.getItem('customBg');
  
  log(`Current theme state:`);
  log(`  Theme: ${theme}`);
  log(`  Custom background: ${customBg || 'none'}`);
  
  // List all the CSS variables that should be consistent
  const variables = [
    '--bg', '--fg', '--accent', '--border', '--muted',
    '--menu-bg', '--menu-fg', '--note-bg', '--note-hover-bg',
    '--modal-overlay', '--hover-bg'
  ];
  
  log(`CSS variables that should be consistent between pages:`);
  variables.forEach(variable => {
    log(`  ${variable}`);
  });
  
  log(`If colors don't match, check that both pages use the same CSS variable values`);
}

// Initial setup
document.addEventListener('DOMContentLoaded', () => {
  log('Editor color alignment test loaded');
  log('TESTING INSTRUCTIONS:');
  log('1. Use theme buttons to switch between different themes');
  log('2. Compare main site (left) and editor (right) colors visually');
  log('3. Verify text, backgrounds, and interactive elements match');
  log('4. Test typing in the editor to see placeholder behavior');
  log('5. Test menu interactions and modal popups');
  log('6. Ensure all colors are theme-appropriate and readable');
  
  checkColorVariables();
});
</script>

</body>
</html>
