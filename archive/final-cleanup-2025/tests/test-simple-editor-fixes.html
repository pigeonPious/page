<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß™ Simple Editor Fixes Test</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      padding: 20px;
      font-family: monospace;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid var(--border);
      border-radius: 5px;
      background: var(--sidebar-bg);
    }
    .test-button {
      padding: 10px 15px;
      margin: 5px;
      background: var(--accent);
      color: var(--bg);
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }
    .test-button:hover {
      opacity: 0.8;
    }
    .status-indicator {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 3px;
      font-size: 11px;
      font-weight: bold;
    }
    .status-pass { background: #28a745; color: white; }
    .status-fail { background: #dc3545; color: white; }
    .status-pending { background: #ffc107; color: black; }
    .test-log {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 10px;
      margin: 10px 0;
      border-radius: 3px;
      font-size: 11px;
      max-height: 200px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    .dark-mode .test-log {
      background: #2d3748;
      border-color: #4a5568;
      color: #e2e8f0;
    }
  </style>
</head>
<body class="dark-mode">
  <h1>üß™ Simple Editor Fixes Verification</h1>
  <p>Testing all the fixes applied to simple-editor.html:</p>
  
  <div class="test-section">
    <h3>1. Export Modal Positioning <span id="modal-status" class="status-indicator status-pending">PENDING</span></h3>
    <p>Test if export modal appears centered and visible</p>
    <button class="test-button" onclick="testExportModal()">Test Export Modal</button>
    <div id="modal-log" class="test-log">Waiting for test...</div>
  </div>
  
  <div class="test-section">
    <h3>2. Make Note Functionality <span id="note-status" class="status-indicator status-pending">PENDING</span></h3>
    <p>Test the Make Note (Ctrl+M) feature</p>
    <div contenteditable="true" id="test-content" style="border: 1px solid var(--border); padding: 10px; margin: 10px 0; min-height: 60px; background: var(--bg);">
      Select this text and test the Make Note feature.
    </div>
    <button class="test-button" onclick="testMakeNote()">Test Make Note</button>
    <div id="note-log" class="test-log">Waiting for test...</div>
  </div>
  
  <div class="test-section">
    <h3>3. Category Dropdown Replacement <span id="category-status" class="status-indicator status-pending">PENDING</span></h3>
    <p>Test the new popup category selection system</p>
    <button class="test-button" onclick="testCategoryModal()">Test Category Modal</button>
    <div id="category-log" class="test-log">Waiting for test...</div>
  </div>
  
  <div class="test-section">
    <h3>4. Title Input Styling <span id="title-status" class="status-indicator status-pending">PENDING</span></h3>
    <p>Verify title input has reduced font size (13px) matching body text</p>
    <button class="test-button" onclick="testTitleStyling()">Test Title Styling</button>
    <div id="title-log" class="test-log">Waiting for test...</div>
  </div>
  
  <div class="test-section">
    <h3>5. Export Button Position <span id="export-pos-status" class="status-indicator status-pending">PENDING</span></h3>
    <p>Check if export button is positioned to the right side</p>
    <button class="test-button" onclick="testExportButtonPosition()">Test Export Button Position</button>
    <div id="export-pos-log" class="test-log">Waiting for test...</div>
  </div>
  
  <button class="test-button" onclick="runAllTests()" style="background: #28a745; font-size: 14px; padding: 15px 25px;">üöÄ Run All Tests</button>
  
  <div class="test-section">
    <h3>üìã Test Summary</h3>
    <div id="summary-log" class="test-log">No tests run yet.</div>
  </div>

<script>
let testResults = {};

function log(testName, message) {
  const logElement = document.getElementById(testName + '-log');
  if (logElement) {
    logElement.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
    logElement.scrollTop = logElement.scrollHeight;
  }
}

function setStatus(testName, status) {
  const statusElement = document.getElementById(testName + '-status');
  if (statusElement) {
    statusElement.className = 'status-indicator status-' + status;
    statusElement.textContent = status.toUpperCase();
  }
  testResults[testName] = status;
  updateSummary();
}

function updateSummary() {
  const summary = document.getElementById('summary-log');
  const total = Object.keys(testResults).length;
  const passed = Object.values(testResults).filter(r => r === 'pass').length;
  const failed = Object.values(testResults).filter(r => r === 'fail').length;
  
  summary.textContent = `Tests completed: ${total}\nPassed: ${passed}\nFailed: ${failed}\n\nResults:\n${Object.entries(testResults).map(([test, result]) => `${test}: ${result.toUpperCase()}`).join('\n')}`;
}

function testExportModal() {
  log('modal', 'üß™ Testing export modal positioning...');
  
  // Open simple-editor.html in iframe to test
  const iframe = document.createElement('iframe');
  iframe.src = 'simple-editor.html';
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  
  iframe.onload = function() {
    try {
      const editorWindow = iframe.contentWindow;
      const editorDoc = iframe.contentDocument;
      
      if (editorWindow.localEditor && typeof editorWindow.localEditor.showModal === 'function') {
        log('modal', '‚úÖ showModal function exists');
        
        // Test if showModal function works
        try {
          editorWindow.localEditor.showModal('exportModal');
          log('modal', '‚úÖ showModal call successful');
          setStatus('modal', 'pass');
        } catch (error) {
          log('modal', '‚ùå showModal call failed: ' + error.message);
          setStatus('modal', 'fail');
        }
      } else {
        log('modal', '‚ùå showModal function missing');
        setStatus('modal', 'fail');
      }
    } catch (error) {
      log('modal', '‚ùå Test failed: ' + error.message);
      setStatus('modal', 'fail');
    }
    
    document.body.removeChild(iframe);
  };
}

function testMakeNote() {
  log('note', 'üß™ Testing Make Note functionality...');
  
  const iframe = document.createElement('iframe');
  iframe.src = 'simple-editor.html';
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  
  iframe.onload = function() {
    try {
      const editorWindow = iframe.contentWindow;
      
      if (editorWindow.localEditor && typeof editorWindow.localEditor.makeNote === 'function') {
        log('note', '‚úÖ makeNote function exists');
        setStatus('note', 'pass');
      } else {
        log('note', '‚ùå makeNote function missing');
        setStatus('note', 'fail');
      }
    } catch (error) {
      log('note', '‚ùå Test failed: ' + error.message);
      setStatus('note', 'fail');
    }
    
    document.body.removeChild(iframe);
  };
}

function testCategoryModal() {
  log('category', 'üß™ Testing category modal system...');
  
  const iframe = document.createElement('iframe');
  iframe.src = 'simple-editor.html';
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  
  iframe.onload = function() {
    try {
      const editorDoc = iframe.contentDocument;
      const categoryModal = editorDoc.getElementById('categoryModal');
      const categoryBtn = editorDoc.getElementById('category-btn');
      
      if (categoryModal && categoryBtn) {
        log('category', '‚úÖ Category modal and button elements exist');
        setStatus('category', 'pass');
      } else {
        log('category', '‚ùå Category modal elements missing');
        setStatus('category', 'fail');
      }
    } catch (error) {
      log('category', '‚ùå Test failed: ' + error.message);
      setStatus('category', 'fail');
    }
    
    document.body.removeChild(iframe);
  };
}

function testTitleStyling() {
  log('title', 'üß™ Testing title input styling...');
  
  const iframe = document.createElement('iframe');
  iframe.src = 'simple-editor.html';
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  
  iframe.onload = function() {
    try {
      const editorDoc = iframe.contentDocument;
      const titleInput = editorDoc.getElementById('postTitle');
      
      if (titleInput) {
        const styles = iframe.contentWindow.getComputedStyle(titleInput);
        const fontSize = parseInt(styles.fontSize);
        const fontWeight = styles.fontWeight;
        
        log('title', `Current title styling: font-size: ${fontSize}px, font-weight: ${fontWeight}`);
        
        if (fontSize === 13 && (fontWeight === 'normal' || fontWeight === '400')) {
          log('title', '‚úÖ Title styling is correct (13px, normal weight)');
          setStatus('title', 'pass');
        } else {
          log('title', '‚ùå Title styling incorrect - should be 13px font, normal weight');
          setStatus('title', 'fail');
        }
      } else {
        log('title', '‚ùå Title input element not found');
        setStatus('title', 'fail');
      }
    } catch (error) {
      log('title', '‚ùå Test failed: ' + error.message);
      setStatus('title', 'fail');
    }
    
    document.body.removeChild(iframe);
  };
}

function testExportButtonPosition() {
  log('export-pos', 'üß™ Testing export button positioning...');
  
  const iframe = document.createElement('iframe');
  iframe.src = 'simple-editor.html';
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  
  iframe.onload = function() {
    try {
      const editorDoc = iframe.contentDocument;
      const editorToolsRight = editorDoc.querySelector('.editor-tools-right');
      const exportButton = editorDoc.querySelector('[onclick*="exportPost"]');
      
      if (editorToolsRight && exportButton) {
        const isInRightContainer = editorToolsRight.contains(exportButton);
        
        if (isInRightContainer) {
          log('export-pos', '‚úÖ Export button is positioned in right container');
          setStatus('export-pos', 'pass');
        } else {
          log('export-pos', '‚ùå Export button not in right container');
          setStatus('export-pos', 'fail');
        }
      } else {
        log('export-pos', '‚ùå Export button or right container not found');
        setStatus('export-pos', 'fail');
      }
    } catch (error) {
      log('export-pos', '‚ùå Test failed: ' + error.message);
      setStatus('export-pos', 'fail');
    }
    
    document.body.removeChild(iframe);
  };
}

function runAllTests() {
  testResults = {};
  document.querySelectorAll('.test-log').forEach(log => log.textContent = 'Running...\n');
  document.querySelectorAll('.status-indicator').forEach(status => {
    status.className = 'status-indicator status-pending';
    status.textContent = 'RUNNING';
  });
  
  setTimeout(() => testExportModal(), 100);
  setTimeout(() => testMakeNote(), 300);
  setTimeout(() => testCategoryModal(), 500);
  setTimeout(() => testTitleStyling(), 700);
  setTimeout(() => testExportButtonPosition(), 900);
}

// Test keyboard shortcut
document.addEventListener('keydown', function(e) {
  if (e.ctrlKey && e.key === 'm') {
    e.preventDefault();
    log('note', '‚å®Ô∏è Ctrl+M detected - this would trigger Make Note in simple-editor.html');
  }
});
</script>
</body>
</html>
