<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Fixed Editor</title>
  <link rel="icon" href="data:,">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .test-result { margin: 10px 0; padding: 10px; border-radius: 4px; }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    .test-btn { padding: 8px 16px; margin: 5px; background: #007cba; color: white; border: none; border-radius: 3px; cursor: pointer; }
    .iframe-container { margin: 20px 0; border: 1px solid #ccc; }
  </style>
</head>
<body>

<h1>üß™ Editor Button Test</h1>

<div class="test-result">
  <h3>Testing Editor Button Functionality</h3>
  <button class="test-btn" onclick="testEditorButtons()">Test All Buttons</button>
  <button class="test-btn" onclick="testKeywordsButton()">Test FLAGS Button</button>
  <button class="test-btn" onclick="testExportButton()">Test EXPORT Button</button>
  <button class="test-btn" onclick="testImagesButton()">Test IMAGES Button</button>
  <button class="test-btn" onclick="testPublishButton()">Test PUBLISH Button</button>
</div>

<div id="test-results"></div>

<div class="iframe-container">
  <iframe id="editorFrame" src="editor.html" width="100%" height="600"></iframe>
</div>

<script>
function log(message, type = 'info') {
  const resultsDiv = document.getElementById('test-results');
  const className = type === 'success' ? 'success' : type === 'error' ? 'error' : '';
  resultsDiv.innerHTML += `<div class="test-result ${className}">${new Date().toLocaleTimeString()}: ${message}</div>`;
}

function getEditorWindow() {
  return document.getElementById('editorFrame').contentWindow;
}

function testEditorButtons() {
  log('üß™ Starting comprehensive button test...', 'info');
  
  const editorWindow = getEditorWindow();
  
  setTimeout(() => {
    try {
      const editorDoc = editorWindow.document;
      const editor = editorWindow.editor;
      
      if (!editor) {
        log('‚ùå Editor object not found in iframe', 'error');
        return;
      }
      
      // Test each button
      const buttons = [
        { id: 'keywords-btn', name: 'FLAGS' },
        { id: 'export-btn', name: 'EXPORT' },
        { id: 'images-btn', name: 'IMAGES' },
        { id: 'publish-btn', name: 'PUBLISH' }
      ];
      
      buttons.forEach(button => {
        const btn = editorDoc.getElementById(button.id);
        if (btn) {
          log(`‚úÖ Found ${button.name} button`, 'success');
          
          // Test click
          try {
            btn.click();
            log(`‚úÖ ${button.name} button click triggered`, 'success');
          } catch (error) {
            log(`‚ùå ${button.name} button click failed: ${error.message}`, 'error');
          }
        } else {
          log(`‚ùå ${button.name} button not found`, 'error');
        }
      });
      
    } catch (error) {
      log(`‚ùå Test failed: ${error.message}`, 'error');
    }
  }, 1000);
}

function testKeywordsButton() {
  const editorWindow = getEditorWindow();
  setTimeout(() => {
    try {
      const btn = editorWindow.document.getElementById('keywords-btn');
      if (btn) {
        btn.click();
        log('‚úÖ FLAGS button clicked', 'success');
      } else {
        log('‚ùå FLAGS button not found', 'error');
      }
    } catch (error) {
      log(`‚ùå FLAGS test failed: ${error.message}`, 'error');
    }
  }, 500);
}

function testExportButton() {
  const editorWindow = getEditorWindow();
  setTimeout(() => {
    try {
      const btn = editorWindow.document.getElementById('export-btn');
      if (btn) {
        btn.click();
        log('‚úÖ EXPORT button clicked', 'success');
      } else {
        log('‚ùå EXPORT button not found', 'error');
      }
    } catch (error) {
      log(`‚ùå EXPORT test failed: ${error.message}`, 'error');
    }
  }, 500);
}

function testImagesButton() {
  const editorWindow = getEditorWindow();
  setTimeout(() => {
    try {
      const btn = editorWindow.document.getElementById('images-btn');
      if (btn) {
        btn.click();
        log('‚úÖ IMAGES button clicked', 'success');
      } else {
        log('‚ùå IMAGES button not found', 'error');
      }
    } catch (error) {
      log(`‚ùå IMAGES test failed: ${error.message}`, 'error');
    }
  }, 500);
}

function testPublishButton() {
  const editorWindow = getEditorWindow();
  setTimeout(() => {
    try {
      const btn = editorWindow.document.getElementById('publish-btn');
      if (btn) {
        btn.click();
        log('‚úÖ PUBLISH button clicked', 'success');
      } else {
        log('‚ùå PUBLISH button not found', 'error');
      }
    } catch (error) {
      log(`‚ùå PUBLISH test failed: ${error.message}`, 'error');
    }
  }, 500);
}

// Auto-test when iframe loads
document.getElementById('editorFrame').onload = () => {
  log('üìÑ Editor iframe loaded', 'info');
  setTimeout(() => {
    log('üîç Checking editor initialization...', 'info');
    const editorWindow = getEditorWindow();
    try {
      if (editorWindow.editor) {
        log('‚úÖ Editor object found', 'success');
      } else {
        log('‚ùå Editor object not found', 'error');
      }
    } catch (error) {
      log(`‚ùå Error accessing editor: ${error.message}`, 'error');
    }
  }, 2000);
};

log('üöÄ Test page loaded - waiting for editor iframe...', 'info');
</script>

</body>
</html>
