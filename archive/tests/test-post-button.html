<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Post Button Test</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="menu-bar">
  <div class="menu-bar-inner">
    <div class="menu-star">*</div>
    <div class="menu-item"><div class="label">Test</div></div>
    <div id="auth-status" style="margin-left: auto; padding: 5px 10px; font-size: 12px; color: var(--muted);">Checking login...</div>
  </div>
</div>

<div style="padding: 40px;">
  <h1>Post Button Manual Test</h1>
  
  <div style="margin-bottom: 20px;">
    <h3>Test Steps:</h3>
    <ol>
      <li>Make sure you're logged in (check status above)</li>
      <li>Open browser console (F12)</li>
      <li>Enter test content below</li>
      <li>Click the Post button</li>
      <li>Watch console for debugging output</li>
    </ol>
  </div>
  
  <div style="margin-bottom: 20px;">
    <label for="editorContent">Content:</label><br>
    <textarea id="editorContent" style="width: 500px; height: 100px;" placeholder="Enter test content...">Test post from manual test page</textarea>
  </div>
  
  <div style="margin-bottom: 20px;">
    <label for="categorySelect">Category:</label>
    <select id="categorySelect">
      <option value="general">General</option>
      <option value="tech">Tech</option>
    </select>
  </div>
  
  <button id="postToGitHub" class="bold-button" style="padding: 10px 20px; font-size: 16px;">Post</button>
  
  <div style="margin-top: 20px;">
    <h3>Manual Button Test:</h3>
    <button onclick="testButtonDirectly()" style="padding: 10px 20px; background: red; color: white;">Direct Function Call</button>
    <button onclick="testElementQuery()" style="padding: 10px 20px; background: blue; color: white;">Test Element Query</button>
  </div>
  
  <div id="test-output" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; min-height: 100px; background: #f5f5f5;">
    Console output will appear here...
  </div>
</div>

<!-- Modal elements needed for EditorManager -->
<div id="noteModal" class="modal" style="display: none;">
  <div class="modal-content">
    <h3>Test Modal</h3>
  </div>
</div>

<div id="categoryModal" class="modal" style="display: none;">
  <div class="modal-content">
    <h3>Test Modal</h3>
  </div>
</div>

<div id="messageModal" class="modal" style="display: none;">
  <div class="modal-content">
    <h3 id="messageTitle">Message</h3>
    <p id="messageText"></p>
    <div class="modal-buttons">
      <button id="closeMessage" class="add-btn">OK</button>
    </div>
  </div>
</div>

<script>
// Override console.log to also display in the page
const originalLog = console.log;
const output = document.getElementById('test-output');

console.log = function(...args) {
  originalLog.apply(console, args);
  if (output) {
    output.innerHTML += args.join(' ') + '<br>';
    output.scrollTop = output.scrollHeight;
  }
};

// Test functions
function testButtonDirectly() {
  output.innerHTML += '<strong>üß™ Testing direct function call...</strong><br>';
  if (window.editorManager && window.editorManager.handlePost) {
    output.innerHTML += '‚úÖ EditorManager found, calling handlePost()...<br>';
    window.editorManager.handlePost();
  } else {
    output.innerHTML += '‚ùå EditorManager not found or handlePost not available<br>';
  }
}

function testElementQuery() {
  output.innerHTML += '<strong>üîç Testing element queries...</strong><br>';
  const elements = {
    postBtn: document.getElementById('postToGitHub'),
    content: document.getElementById('editorContent'),
    category: document.getElementById('categorySelect')
  };
  
  for (const [name, element] of Object.entries(elements)) {
    output.innerHTML += name + ': ' + (element ? '‚úÖ Found' : '‚ùå Not found') + '<br>';
  }
  
  // Test event listener
  const postBtn = elements.postBtn;
  if (postBtn) {
    output.innerHTML += 'Testing click event...<br>';
    postBtn.click();
  }
}

// Initialize and load the script
console.log('üöÄ Starting Post Button Test Page...');
</script>

<script src="script.js"></script>
<script src="auth.js"></script>

<script>
// Make editorManager globally available for testing
window.addEventListener('load', () => {
  console.log('‚úÖ Page loaded, editorManager available:', !!window.editorManager);
});
</script>
</body>
</html>
