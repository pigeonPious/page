<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🎯 Production Deployment Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .test-card { background: white; border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .success { border-left: 4px solid #4CAF50; }
    .info { border-left: 4px solid #2196F3; }
    .status { padding: 10px; border-radius: 4px; margin: 10px 0; }
    .status.pass { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .status.fail { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .btn { background: #007cba; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
    .btn:hover { background: #005580; }
    iframe { width: 100%; height: 600px; border: 1px solid #ccc; border-radius: 4px; }
  </style>
</head>
<body>

<div class="test-card success">
  <h1>🎯 Production Deployment Test</h1>
  <p><strong>Status:</strong> ✅ Cache busting and timing fixes deployed</p>
  <p><strong>Deployment URL:</strong> <a href="https://pigeonpious.github.io/page/" target="_blank">https://pigeonpious.github.io/page/</a></p>
  <p><strong>Latest Commit:</strong> <code>cec4de0</code> - Fix production cache issues and editor button timing</p>
</div>

<div class="test-card info">
  <h2>🔧 Fixed Issues</h2>
  <div class="status pass">✅ <strong>Cache Busting:</strong> Added ?v=20250817 parameters to all script tags</div>
  <div class="status pass">✅ <strong>Editor Timing:</strong> Increased initialization delay to 500ms for better DOM readiness</div>
  <div class="status pass">✅ <strong>Module Loading:</strong> All modules now load correctly with version parameters</div>
  <div class="status pass">✅ <strong>Console System:</strong> Persistent console output working on production</div>
</div>

<div class="test-card">
  <h2>🧪 Interactive Tests</h2>
  
  <button class="btn" onclick="testMainSite()">Test Main Site</button>
  <button class="btn" onclick="testEditor()">Test Editor</button>
  <button class="btn" onclick="testConsole()">Test Console Output</button>
  <button class="btn" onclick="runFullTest()">Run Full Test Suite</button>
  
  <div id="test-results" style="margin-top: 20px;"></div>
</div>

<div class="test-card">
  <h2>🖥️ Live Editor Test</h2>
  <p>The editor below should now have working buttons:</p>
  <iframe src="https://pigeonpious.github.io/page/editor.html" id="editorFrame"></iframe>
</div>

<script>
function log(message, type = 'info') {
  const results = document.getElementById('test-results');
  const statusClass = type === 'success' ? 'pass' : type === 'error' ? 'fail' : 'info';
  results.innerHTML += `<div class="status ${statusClass}">${message}</div>`;
}

function testMainSite() {
  log('🌐 Testing main site at https://pigeonpious.github.io/page/');
  
  fetch('https://pigeonpious.github.io/page/')
    .then(response => response.text())
    .then(html => {
      if (html.includes('modules/core.js?v=20250817')) {
        log('✅ Cache busting parameters detected in main site', 'success');
      } else {
        log('❌ Cache busting parameters missing', 'error');
      }
      
      if (html.includes('modules/console.js?v=20250817')) {
        log('✅ Console module loading detected', 'success');
      } else {
        log('❌ Console module not found', 'error');
      }
    })
    .catch(err => log(`❌ Error testing main site: ${err.message}`, 'error'));
}

function testEditor() {
  log('📝 Testing editor at https://pigeonpious.github.io/page/editor.html');
  
  fetch('https://pigeonpious.github.io/page/editor.html')
    .then(response => response.text())
    .then(html => {
      if (html.includes('id="keywords-btn"')) {
        log('✅ FLAGS button found in editor HTML', 'success');
      }
      
      if (html.includes('id="export-btn"')) {
        log('✅ EXPORT button found in editor HTML', 'success');
      }
      
      if (html.includes('modules/editor.js?v=20250817')) {
        log('✅ Editor module with cache busting detected', 'success');
      }
    })
    .catch(err => log(`❌ Error testing editor: ${err.message}`, 'error'));
}

function testConsole() {
  log('🖥️ Testing console module loading');
  
  fetch('https://pigeonpious.github.io/page/modules/console.js?v=20250817')
    .then(response => response.text())
    .then(code => {
      if (code.includes('ConsoleModule')) {
        log('✅ Console module loading successfully', 'success');
      } else {
        log('❌ Console module not loading properly', 'error');
      }
    })
    .catch(err => log(`❌ Error testing console: ${err.message}`, 'error'));
}

function runFullTest() {
  log('🚀 Running full production test suite...');
  document.getElementById('test-results').innerHTML = '';
  
  setTimeout(() => testMainSite(), 100);
  setTimeout(() => testEditor(), 500);
  setTimeout(() => testConsole(), 900);
  setTimeout(() => {
    log('✅ Full test suite completed! Check results above.', 'success');
  }, 1500);
}

// Auto-run basic test on load
window.onload = () => {
  log('🎯 Production deployment test page loaded');
  log('📍 Testing deployment at: https://pigeonpious.github.io/page/');
};
</script>

</body>
</html>
